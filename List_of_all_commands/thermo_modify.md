# thermo_modify command

## 構文
```
thermo_modify keyword value ...
```
1つ以上のキーワード/値のペアをリストできます。

keyword = lost または norm または flush または line または format

lost の値 = error または warn または ignore

error: ロストした原子がエラーとして扱われる  
warn: ロストした原子が警告として扱われる  
ignore: ロストした原子を無視する

norm の値 = yes または no  
yes: 出力を正規化する  
no: 正規化しない  

flush の値 = yes または no
yes: バッファをフラッシュしてすぐに出力する  
no: バッファリングを維持する  

line の値 = one または multi  
one: 1行で出力する  
multi: 複数行で出力する  

format の値 = int string または float string または M string

M = 1からNまでの整数、ここでNは出力される量の数
string = Cスタイルの書式文字列

## 例
```
thermo_modify lost ignore flush yes
thermo_modify line multi format float %g
```

## 説明
LIGGGHTS(R)-PUBLICが熱力学情報を計算および出力する方法に関するオプションを設定します。

[!WARMING]これらのオプションは現在定義されているthermo_styleに適用されます。[thermo_style]()コマンドを指定すると、すべての熱力学設定がデフォルト値にリセットされ、thermo_modifyコマンドによって以前にリセットされた設定も含まれます。したがって、入力スクリプトでthermo_styleコマンドを指定した場合、その後にthermo_modifyコマンドを使用する必要があります。

lostキーワードは、LIGGGHTS(R)-PUBLICが熱力学を計算するたびにロストした原子をチェックするかどうか、および原子がロストした場合に何をするかを決定します。原子は、非周期的なシミュレーションボックス境界を越えて移動した場合や、再隣接処理が行われる前にシミュレーション領域外（またはプロセッササブドメイン長を超えて）に移動した場合に「ロスト」する可能性があります。後者のケースは通常、動力学の不具合が原因であり、例えばタイムステップが大きすぎるか、力や速度が大きすぎることが考えられます。値がignoreの場合、LIGGGHTS(R)-PUBLICはロストした原子をチェックしません。errorまたはwarnの場合、LIGGGHTS(R)-PUBLICはチェックを行い、エラーまたは警告を発行します。エラーが発生するとコードは終了し、警告は1回のみ（最初に原子がロストしたとき）発行されます。これはデバッグのために役立つオプションです。

[!WARNING]計算効率のため、このロストチェックはシステム内の原子の総数が減少したかどうかを単純に確認するチェックです。したがって、粒子が継続的に挿入されるシミュレーションでは、「ロスト」した原子が検出されない場合があります。

normキーワードは、さまざまな熱力学的出力値が原子の数で正規化されるかどうかを決定します。yesまたはnoに設定することができます。この設定のデフォルトは、ユニットスタイルによって異なります（下記参照）。normがyesに設定されていても、値は「広がりのある」量（システム内の原子数に比例する量）である場合にのみ正規化されます。[thermo_style]()コマンドのドキュメントページで説明されているthermoキーワードについては、すべてのエネルギー関連のキーワードは広がりのある量です。その他のキーワードは「集中的」な量であり、その値はシステム内の原子数には依存せず、統計的に独立しています。したがって、これらは決して正規化されません。[thermo_style custom]()コマンドで取得した[fix]や[compute]からの熱力学的出力値については、個別のfixやcomputeのドキュメントページに、その値が「広がりのある」または「集中的」であるかが記載されており、それに応じて正規化されるかどうかが示されています。変数式で計算された熱力学的出力値は「集中的」と見なされ、したがって決して正規化されません。この場合でない場合は、変数式で原子数で割る操作を追加することができます。

flushキーワードは、熱力学的情報がログファイルに書き込まれた後にフラッシュ操作を実行します。これにより、シミュレーションが完了する前にLIGGGHTS(R)-PUBLICが停止した場合でも、そのファイル内の出力が最新の状態であることが保証されます（OSによるバッファリングなし）。

lineキーワードは、熱力学的情報が1行に数値の列として印刷されるか、1行に3つの量とテキスト文字列を含む複数行形式で印刷されるかを決定します。後者の場合、ダッシュ線のヘッダーにはタイムステップとCPU時間が含まれます。この修正オプションは、oneおよびmultiのthermo_style設定を上書きします。

formatキーワードは、個々の印刷される量の数値フォーマットを設定します。intおよびfloatキーワードは、すべての整数または浮動小数点数の量のフォーマットを設定します。数値値M（例：format 5 %10.4g）を使った設定は、各出力行で印刷されるM番目の値、例えばこの場合は5番目の列のフォーマットを設定します。特定の列のフォーマットが設定されている場合、それはintまたはfloat設定より優先されます。

[!WARNING]thermo出力値であるstepおよびatomsは、通常の4バイト符号付き整数ではなく、8バイト符号付き整数として内部的に格納されます。format intキーワードを指定する際には、フォーマット文字列で%dスタイルのフォーマット識別子を使用することができ、LIGGGHTS(R)-PUBLICはこれを適用する際に対応する%lu形式に変換します。しかし、format M stringキーワードをstepおよびnatomsに対して指定する場合、8バイト符号付き整数に適した文字列を指定する必要があります。例えば、%ldなどです。

## 制限事項
none

## 関連コマンド
[thermo](), [thermo_style]()

## デフォルト
オプションのデフォルト値は、次の通りです：
- lost = ignore
- norm = yes（単位スタイルがljの場合）、norm = no（単位スタイルがrealおよびmetalの場合）
- flush = no

lineおよびformatオプションのデフォルト値は、thermoスタイルによって異なります。スタイルが「one」または「custom」の場合、lineおよびformatのデフォルト値は「one」、「%8d」、「%12.8g」です。スタイルが「multi」の場合、lineおよびformatのデフォルト値は「multi」、「%8d」、「%14.4f」です。