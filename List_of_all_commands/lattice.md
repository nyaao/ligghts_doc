# lattice command

## 構文
```
lattice style scale keyword values ...
```

スタイル = none または sc または bcc または fcc または hcp または diamond または sq または sq2 または hex または custom
スケール = 格子とシミュレーションボックスの間のスケールファクター

```
scale = reduced density rho* (for LJ units)
scale = lattice constant in distance units (for all other units)
```

ゼロ個以上のキーワード/値のペアを追加できます
キーワード = origin または orient または spacing または a1 または a2 または a3 または basis

origin の値 = x y z
x, y, z = 単位セルの分数 (0 <= x, y, z < 1)

orient の値 = dim i j k
dim = x または y または z
i, j, k = 整数格子方向

spacing の値 = dx dy dz
dx, dy, dz = x, y, z のボックス方向における格子間隔

a1, a2, a3 の値 = x y z
x, y, z = 単位セルを定義する原始ベクトルの成分

basis の値 = x y z
x, y, z = 基底原子の分数座標 (0 <= x, y, z < 1)

## 例
```
lattice fcc 3.52
lattice hex 0.85
lattice sq 0.8 origin 0.0 0.5 0.0 orient x 1 1 0 orient y -1 1 0
lattice custom 3.52 a1 1.0 0.0 0.0 a2 0.5 1.0 0.0 a3 0.0 0.0 0.5 &
                    basis 0.0 0.0 0.0 basis 0.5 0.5 0.5
lattice none 2.0
```

## 説明
LIGGGHTS(R)-PUBLICで格子を定義して、他のコマンドで使用することができます。LIGGGHTS(R)-PUBLICにおける格子は、単位セルと基底原子によって決定される空間内の点の集合であり、その点はすべての次元で無限に複製されます。latticeコマンドの引数は、さまざまな結晶格子を定義するために使用できます。

LIGGGHTS(R)-PUBLICでは、格子は2通りの方法で使用されます。第一に、[create_atoms]()コマンドは、シミュレーションボックス内の格子点に原子を作成します。[create_atoms]()コマンドでは、格子の異なる基底原子に異なる原子タイプを割り当てることができます。第二に、格子によって暗黙的に示されるx, y, zの各方向の格子間隔は、他のコマンド（例えば、[create_box]()、[region]()、[velocity]()など）で距離の単位として使用されることがあります。これは、基盤となる問題の幾何学が格子上の原子である場合に便利です。

格子スタイルはシミュレーションの次元と一致している必要があります - [dimension]()コマンドを参照してください。スタイルsc、bcc、fcc、hcp、diamondは3D問題用です。スタイルsq、sq2、hexは2D問題用です。スタイルcustomは、2Dまたは3Dの問題のいずれにも使用できます。

格子は、単位セル、そのセル内の基底原子のセット、および単位セルをシミュレーションボックスにマッピングするための変換パラメータ（scale、origin、orient）で構成されます。ベクトルa1、a2、a3は単位セルの辺のベクトルです。これは固体状態結晶学における「原始」ベクトルの命名法ですが、LIGGGHTS(R)-PUBLICでは、これらのベクトルが決定する単位セルは必ずしも最小体積の「原始セル」である必要はありません。

スタイル「none」の格子は単位セルと基底セットを定義しないため、[create_atoms]()コマンドと一緒に使用することはできません。しかし、指定されたscaleパラメータを使用して格子間隔を定義します。上記のように、x、y、zの格子間隔は他のコマンドで距離単位として使用できます。noneスタイルには追加のキーワード/値ペアを指定することはできません。デフォルトでは「lattice none 1.0」が定義されており、これは格子間隔が1.0（[units]()コマンドで定義された距離単位）であることを意味します。

スタイルsc、fcc、bcc、およびdiamondの格子は、辺の長さが1.0の立方体単位セルを定義する3D格子です。つまり、a1 = 1 0 0、a2 = 0 1 0、a3 = 0 0 1です。スタイルhcpでは、a1 = 1 0 0、a2 = 0 sqrt(3) 0、a3 = 0 0 sqrt(8/3)です。単位セル内の基底原子の配置は、固体物理学の教科書に記載されています。sc格子には立方体の左下隅に1つの基底原子があります。bcc格子には、1つは角に、もう1つは立方体の中心に基底原子が2つあります。fcc格子には、1つは角に、残りの3つは立方体の面の中心に基底原子が4つあります。hcp格子には、z = 0の平面に2つ、z = 0.5の平面に2つの基底原子があり、合計で4つの基底原子があります。diamond格子には基底原子が8つあります。

スタイル「sq」と「sq2」の格子は、辺の長さが1.0の正方形単位セルを定義する2D格子です。つまり、a1 = 1 0 0 および a2 = 0 1 0 です。sq格子には、正方形の左下隅に1つの基底原子があります。sq2格子には、1つは角に、もう1つは正方形の中央に基底原子が2つあります。hexスタイルも2D格子ですが、単位セルは長方形で、a1 = 1 0 0 および a2 = 0 sqrt(3) 0 です。2つの基底原子があり、1つは角に、もう1つは長方形の中央にあります。

スタイル「custom」の格子は、a1、a2、a3を指定し、単位セルに配置する基底原子のリストを定義できます。デフォルトでは、a1、a2、a3は3つの直交した単位ベクトル（単位立方体の辺）ですが、これらのベクトルは任意の長さに設定でき、互いに直交していないことも可能です。この場合、傾いた平行六面体を表現することができます。basisキーワードを使って、基底原子を1つずつ単位セルに追加します。引数は分数座標（0.0 <= x, y, z < 1.0）で、例えば0.5の値はその次元で単位セルの中央に位置することを意味します。


このサブセクションでは、理想化された単位セルがシミュレーションボックス内の格子点にどのように変換されるかを決定する引数について説明します。

scale引数は、単位セルがシミュレーションボックスにマッピングされる際に、単位セルのサイズがどのようにスケーリングされるかを決定します。つまり、単位セルに掛けるべき乗数因子を決定し、それによってシミュレーションボックス内での所望のサイズと距離単位を持つ格子を作成します。scale引数の意味は、使用しているシミュレーションの[units]()に依存します。

ljスタイル以外のすべての単位スタイルでは、scale引数は単位スタイルで定義された距離単位で指定されます。例えば、realやmetal単位の場合、単位セルが辺の長さ1.0の単位立方体であれば、scale = 3.52を指定すると、3.52オングストロームの間隔を持つ立方体格子が作成されます。cgs単位では、間隔は3.52cmとなります。

単位スタイルがljの場合、scale引数はLennard-Jonesの縮小密度、通常はrhoとして表記されます。LIGGGHTS(R)-PUBLICは、この値を次の式を用いて乗数因子に変換します：「factor^dim = rho/rho」、ここでrhoはN/V（Vは格子単位セルの体積、Nは単位セル内の基底原子の数）であり、dimはシミュレーションの次元（2または3）です。実際には、LJ粒子のサイズがsigma = 1.0の場合、粒子の格子は所望の縮小密度に配置されることを意味します。

originオプションは、単位セルがシミュレーションボックスにマッピングされる際に、単位セルがどのようにシフトまたは移動するかを指定します。x、y、zの値は分数値（0.0 <= x, y, z < 1.0）であり、各次元における格子間隔の一部として格子をシフトします。「格子間隔」の意味については、後述します。

orientオプションは、単位セルがシミュレーションボックスにマッピングされる際に、単位セルがどのように回転するかを指定します。dim引数はシミュレーションボックス内の3つの座標軸のいずれかです。他の3つの引数は、回転させたい格子内の結晶方向で、整数として指定されます。例えば、「orient x 2 1 0」は、シミュレーションボックス内のx軸が[210]格子方向になることを意味します。指定した3つの格子方向は互いに直交しており、右手の法則に従う必要があります。すなわち、(X × Y)はZ方向を指します。この記述は、実際には直交格子にのみ適用されます。非直交のa1、a2、a3ベクトルを持つより一般的な格子スタイルcustomを使用している場合、3つのorientオプションは3x3の回転行列を作成し、それがa1、a2、a3に適用されて、元の単位セルがシミュレーションボックス内で新しい方向に回転されると考えてください。

いくつかのLIGGGHTS(R)-PUBLICコマンドでは、x、y、z方向の「格子間隔」から推測される距離単位を使用するオプションがあります。例えば、[region]()コマンドは10x20x20のサイズのブロックを作成できます。この場合、10はx方向で10個の格子間隔を意味します。

spacingオプションは、3つの格子間隔を直接設定します。すべての値はゼロであってはならず（2Dシミュレーションではdzに1.0を使用）、指定された値は、上記で説明したスケール因子に関連付けられた乗数因子で掛け算されます。したがって、1.0の間隔はスケール因子に関係なく1つの単位セルを意味します。このオプションは、LIGGGHTS(R)-PUBLICが計算した間隔が後続のコマンドで使用するには不便な場合に有用です。特に非直交または回転した格子の場合などです。

spacingオプションが指定されていない場合、LIGGGHTS(R)-PUBLICは次の方法で格子間隔を計算します。格子の単位セルはシミュレーションボックスにマッピングされ（スケール、シフト、回転）、その結果、（おそらく）サイズと方向が変更されます。X方向の格子間隔は、変更された単位セルの8つのコーナーポイントのx座標の最小値と最大値の差として定義されます。同様に、YおよびZ方向の格子間隔は、それぞれyおよびz座標の最小値と最大値の差として定義されます。

単位セルが直交しており、軸に沿ったエッジを持つ（orientキーワードで回転していない）場合、各次元の格子間隔は単にスケール因子（上記で説明）にa1、a2、a3の長さを掛けたものになります。したがって、スケール因子が3.0オングストロームのhexスタイルの格子では、x方向の格子間隔は3.0、y方向は3*sqrt(3.0)になります。

[!WARNING]非直交単位セルの場合や、orientキーワードを使用して回転を適用した場合、格子間隔は直感的でないことがあります。特にこのような場合、格子間隔がその方向の格子の周期性の整数倍であることは保証されません。したがって、ある次元において格子間隔の倍数のサイズを持つ直交周期シミュレーションボックスを作成し、その後create_atomsコマンドで原子を配置しても、必ずしも周期的なシステムは作成されません。つまり、シミュレーションボックスの面で原子が不適切に重なり合う可能性があります。

これらの問題にもかかわらず、LIGGGHTS(R)-PUBLICが計算した格子間隔の値は出力されるため、格子間隔を使用するコマンドにおけるその影響は解読可能であるべきです。

## 制限事項
a1, a2, a3, basis キーワードは、スタイル custom のみで使用できます。

## 関連コマンド
[dimension](), [create_atoms](), [region]()

## デフォルト
```
lattice none 1.0
```

他の格子スタイルでは、オプションのデフォルト値は次の通りです：

origin = 0.0 0.0 0.0  
orient = x 1 0 0  
orient = y 0 1 0  
orient = z 0 0 1  
a1 = 1 0 0  
a2 = 0 1 0  
a3 = 0 0 1  