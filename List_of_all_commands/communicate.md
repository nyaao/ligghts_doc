# communicate command

## 構文
```
communicate style keyword value ...
```

style = （シングルもしくはマルチ）single or multi
0個以上のキーワード/値のペアを後ろに追加できます。
keyword = カットオフ、グループもしくはvel (cutoff or group or vel)

cutoff の値 = Rcut（距離の単位）= この距離だけ離れた原子まで通信します。
group の値 = group-ID = 指定したグループ内の原子のみを通信します。
vel の値 = yes または no = ゴースト原子に速度情報を通信するかどうかを指定します。

## 例
```
communicate multi
communicate multi group solvent
communicate single vel yes
communicate single cutoff 5.0 vel yes

```

## 説明
このコマンドは、各タイムステップで隣接するプロセッサ間で原子の座標やその他の特性が交換され、それらがゴースト原子の特性として保存される際のプロセッサ間通信のスタイルを設定します。

デフォルトのスタイルは single で、各プロセッサが自身のサブドメインから単一の距離内にあるゴースト原子の情報を取得することを意味します。この距離は、すべての原子タイプペアに対する近傍カットオフの最大値です。

多くのシステムでは、このアルゴリズムは効率的ですが、異なるタイプペア間でカットオフが大きく異なるシステムでは、multi スタイルの方が高速になる場合があります。この場合、各原子タイプに通信用の独自の距離カットオフが割り当てられ、通信される原子の数が減少します。ただし、粒状システムでは、single スタイルで自動的に最適化が行われるため、multi スタイルは必要なく、使用できません。このようなシミュレーションに有効な近傍リスト構築オプションについては、[neighbor multi]() コマンドを参照してください。

cutoff オプションでは、ゴースト原子を他のプロセッサから取得する際の、プロセッサのサブドメイン境界からの距離（ゴーストカットオフ距離）を設定できます。デフォルトでは、ゴーストカットオフ = 近傍カットオフ = ペアワイズ力のカットオフ + 近傍スキンです。スキン距離の詳細については、[neighbor]() コマンドを参照してください。指定された Rcut が近傍カットオフより大きい場合、追加のゴースト原子が取得されます。一方、Rcut が近傍カットオフより小さい場合、ゴーストカットオフは近傍カットオフに設定されます。

以下は、ゴーストカットオフを近傍カットオフより大きく設定すると有用、または必要になるシミュレーションシナリオです：

ペアワイズ相互作用がなく、結合相互作用のみを持つ単一のポリマー鎖。
結合相互作用（例: ジヒードラル）がペアワイズカットオフよりも遠くまで及ぶ場合。
計算のためにペアワイズカットオフを超えたゴースト原子が必要な場合。
最初のシナリオでは、ペアワイズポテンシャルが定義されていません。そのため、ペアワイズ近傍カットオフは 0.0 になります。しかし、ゴースト原子は異なるプロセッサ上の原子間、または周期境界をまたぐ相互作用の結合、角度などを計算するために依然として必要です。

適切なゴーストカットオフは、[newton bond]() の設定によって異なります。

newton bond off の場合: 距離は、結合内の任意の2つの原子間で最も遠い距離である必要があります。例えば、ジヒードラルにおける1-4原子間の距離です。
newton bond on の場合: 距離は、結合、角度などの中心原子と他の任意の原子間の距離で十分です。例えば、ジヒードラルにおける2-4原子間の距離です。
第2のシナリオでは、ペアワイズポテンシャルが定義されていますが、近傍カットオフが十分に長くなく、結合、角度などの項を計算することができません。この場合も、前述のシナリオと同様に適切なゴーストカットオフを設定する必要があります。

最後のシナリオでは、[fix]()、[compute]()、または[pairwise potential]()が、通常のペアワイズカットオフを超えたゴースト原子を使用して計算を行う必要があります（例えば、多体ペアポテンシャルでゴースト原子の近傍を特定する場合）。適切なゴーストカットオフを設定することで、必要な原子を見つけられるようになります。

[!WARNING]これらのシナリオで、ゴーストカットオフを十分に長く設定しない場合、特に周期境界を持つ次元にプロセッサが1つしかない場合（例えば、シリアルで実行している場合）、LIGGGHTS(R)-PUBLIC は探している原子（例: 結合内の相手原子）を見つけるかもしれません。ただし、それはシミュレーションボックスの反対側にあり、周期境界を越えた位置に存在します。このような場合、通常、不適切なダイナミクス（つまり、結合長がシミュレーションボックスの長さになってしまう）が発生します。これが発生しているかどうかを検出するには、  [neigh_modify cluster]() コマンドを参照してください。

group オプションは、通信を指定したグループ内の原子に限定します。これは、特定の種類の粒子にゴースト原子が必要ないモデルで便利です。ただし、すべての原子（指定したグループに属さない原子も含む）は、移動する際に新しいプロセッサへ移動します。このオプションで指定するグループは、[atom_modify first]() コマンドでも指定する必要があります。

vel オプションは、ゴースト粒子との通信時に速度情報を含めるかどうかを設定します。[atom_style]() に応じて、速度情報には粒子の並進速度、角速度、および角運動量が含まれます。vel オプションを yes に設定すると、ゴースト原子がこれらの量を保存しますが、no に設定すると保存しません。yes 設定は、I 粒子と J 粒子の速度状態を必要とする一部のペアスタイルで、ペアワイズ I,J 相互作用を計算する際に必要です。

なお、[fix deform]() コマンドが「remap v」オプションを有効にして使用されている場合、周期境界を越えて反映されたゴースト原子（fix deform グループ内）の速度には、その境界を越える際に生じる速度シフト（例: 拡張やせん断によるもの）による成分も含まれることに注意してください。

## 制限事項
none

## 関連コマンド
[neighbor]()

## デフォルト
デフォルトの設定は次の通りです：
style = single
group = all
cutoff = 0.0
vel = no
cutoff のデフォルト値 0.0 は、ゴーストカットオフ = 近傍カットオフ = ペアワイズ力のカットオフ + 近傍スキンを意味します。