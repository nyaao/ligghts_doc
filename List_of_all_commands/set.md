# set command

## 構文

- styleはシミュレーションにおける対象の選択方法を指定します。以下のスタイルが使用可能です：
atom: 個々の原子を指定  
type: 原子のタイプを指定  
mol: 分子IDを指定  
group: グループIDを指定  
region: 定義された領域を指定  

- IDは選択対象を指定する範囲を意味し、これには以下のような形式が使われます：  
原子ID範囲、タイプ範囲、分子ID範囲、グループID、または領域ID  
- オプションで追加できるキーワード/値のペアには、以下のものがあります：  
type: 原子のタイプ  
type/fraction: 原子のタイプの割合  
mol: 分子ID  
x, y, z: 原子の位置座標  
vx, vy, vz: 原子の速度  
omegax, omegay, omegaz: 原子の角速度  
charge: 原子の電荷  
quat: クォータニオン（回転を表す数値）  
quat_direct: 直接的なクォータニオンの指定  
quat/random: ランダムに生成されるクォータニオン  
diameter: 粒子の直径  
shape: 粒子の形状  
length: 粒子の長さ  
tri: 三角形の形状  
theta: 角度（特に二重結合などの角度に関連）  
angmom: 角運動量  
mass: 質量  
density: 密度  
volume: 体積  
image: 原子の画像（周期境界条件に関連）  
bond: 結合情報  
add: 追加の設定  
until: 特定の条件が満たされるまで  
property/atom: 原子に関連するプロパティ  
blockiness: 粒子の角張り度  

type value = 原子タイプ

valueは原子スタイルの変数で指定可能です。
type/fraction values = タイプ フラクション シード

type = 新しい原子タイプ
fraction = 新しい原子タイプに設定する選択された原子の割合
seed = ランダム #シード（10000より大きい素数）
mol value = 分子ID

valueは原子スタイルの変数で指定可能です。
x, y, z value = 原子座標（距離単位）

valueは原子スタイルの変数で指定可能です。
vx, vy, vz value = 原子速度（速度単位）

valueは原子スタイルの変数で指定可能です。
omegax, omegay, omegaz value = 原子の回転速度（ラジアン / 時間単位）

valueは原子スタイルの変数で指定可能です。
inertiax, inertiay, inertiaz value = スーパー楕円粒子の原子の主慣性モーメント（距離²質量単位）

valueは原子スタイルの変数で指定可能です。
charge value = 原子の電荷（電荷単位）

valueは原子スタイルの変数で指定可能です。
quat values = a b c theta

a, b, c = 右手の法則を使って粒子を回転させるための単位ベクトル
theta = 回転角度（度）
a, b, c, theta は原子スタイルの変数で指定可能です。
quat/random value = シード

seed = クォータニオン方向のランダム #シード（10000より大きい素数）
quat_direct values = q1 q2 q3 q4

q1, q2, q3, q4 = 単位クォータニオンの成分、quat a b c thetaの代わり
diameter value = 球形粒子の直径（距離単位）

valueは原子スタイルの変数で指定可能です。
shape value = Sx Sy Sz

Sx, Sy, Sz = 楕円体の3つの直径、またはスーパー楕円体の半軸（距離単位）
length value = 長さ

len = 線分の長さ（距離単位）
len は原子スタイルの変数で指定可能です。
tri value = 辺の長さ

side = 正三角形の辺の長さ（距離単位）
side は原子スタイルの変数で指定可能です。
theta value = 角度（度）

angle = x軸に対する線分の方向
angle は原子スタイルの変数で指定可能です。
angmom values = Lx Ly Lz

Lx, Ly, Lz = 角運動量ベクトルの成分（距離・質量・速度単位）
Lx, Ly, Lz は原子スタイルの変数で指定可能です。
mass value = 原子単位の質量（質量単位）

valueは原子スタイルの変数で指定可能です。
density value = 球形または楕円体の粒子の密度（質量/距離³または質量/距離²または質量/距離単位、粒子の次元に依存）

valueは原子スタイルの変数で指定可能です。
volume value = ペリダイナミクス粒子の粒子体積（距離³単位）

valueは原子スタイルの変数で指定可能です。
image nx ny nz

nx, ny, nz = シミュレーションボックス内の原子が存在する周期的画像の番号
bond value = 選択した原子間の全ての結合の結合タイプ

add value = yes no

yes = 地域またはグループに対して原子毎の量を追加
until value = 最終タイムステップ

final timestep = 最終タイムステップ値（そのタイムステップまで原子毎の量を追加）
property/atom value = varname var_value0 var_value1 ....

varname = 設定する変数の名前
var_value0**, var_value1 ... = 設定するプロパティの値
valueは原子スタイルの変数で指定可能です。
blockiness values = n1 n2

n1, n2 = スーパー楕円粒子のブロック性パラメータ（2以上）
aspect_ratio values = ky kz

ky, kz = x軸方向に対するy軸およびz軸方向のスーパー楕円粒子のアスペクト比（主座標系で）
粒子のブロック性と体積等価直径は最初に設定する必要があります。

## 例
```
set group solvent type 2
set group solvent type/fraction 2 0.5 123457
set group edge bond 4
set region half charge 0.5
set type 3 charge 0.5
set type 1*3 charge 0.5
set atom 100*200 x 0.5 y 1.0
set atom 1492 type 3
set property/atom Temp 273.15
set atom 3 type 2 shape 0.001 0.001 0.001 blockiness 10.0 10.0 density 2500
```

## 説明
1つ以上の原子のプロパティを設定します。原子のプロパティは、最初に [read_data]()、[read_restart]()、または [create_atoms]() コマンドで割り当てられますが、このコマンドはそれらの割り当てを変更します。これにより、[create_atoms]() コマンドによって割り当てられたデフォルト値（例：charge = 0.0）を上書きすることができます。また、ペアワイズおよび分子間の力の相互作用を変更するためにも有用です。なぜなら、力場の係数は原子タイプを基に定義されるからです。このコマンドは、ダンプファイルで出力されるときに原子のラベリング（原子タイプや分子ID）を変更するためにも使用できます。さらに、デバッグ目的にも便利で、例えば、精密な位置に原子を配置して、後続の力やエネルギーを計算するために使えます。

style と ID 引数が、どの原子のプロパティをリセットするかを決定します。残りのキーワードは、リセットするプロパティと新しい値を指定します。type や mol などの文字列は、スタイルやキーワードとして使用できます。


このセクションでは、style と ID 引数を使って、どの原子のプロパティを変更するかを選択する方法について説明します。

style atom は、原子IDの範囲内のすべての原子を選択します。style type は、タイプの範囲内のすべての原子を選択します。style mol は、分子IDの範囲内のすべての原子を選択します。

範囲指定の方法として、数値を単一で指定するか、ワイルドカードのアスタリスク（*）を使って範囲を指定することができます。形式は「」または「n」、「n」または「mn」のようになります。例えば、style type の場合、N が原子タイプの数であるとき、数値なしのアスタリスクは 1 から N までのすべてのタイプを意味します。先頭にアスタリスクがある場合は、1 から n まで（含む）のすべてのタイプを意味します。末尾にアスタリスクがある場合は、n から N まで（含む）のすべてのタイプを意味します。中央にアスタリスクがある場合は、m から n まで（含む）のすべてのタイプを意味します。mol を除くすべてのスタイルでは、ワイルドカードの最小値は 1 です。mol の場合は 0 です。

style group は、指定したグループに含まれるすべての原子を選択します。style region は、指定した幾何学的領域に含まれるすべての原子を選択します。グループや領域を指定する方法の詳細については、[group]() と [region]() コマンドを参照してください。

このセクションでは、選択した原子のプロパティを変更するためのキーワードオプションについて説明します。

以下で明示的に禁止されていない限り、すべてのキーワードは指定された値として[atom-style variable]()を使用することができます。値が変数の場合、v_name のように変数名を指定する必要があります。この場合、変数は評価され、その結果として得られた原子ごとの値が、各選択された原子に割り当てられる値を決定するために使用されます。

原子スタイルの変数は、さまざまな数学関数を使用して式を指定でき、シミュレーションボックスのパラメータやタイムステップ、経過時間などの [thermo_style]() コマンドのキーワードを含むことができます。また、原子座標などの原子ごとの値も含むことができます。これにより、時間依存または空間依存の原子ごとの値のセットを簡単に指定できます。[variable]()に関するドキュメントページで説明されているように、atomfile スタイルの変数は原子スタイルの変数の代わりに使用でき、したがって set コマンドの引数としても使用できます。atomfile スタイルの変数は、ファイルから原子ごとの値を読み取ります。

[!WARNING]
原子スタイルおよび atomfile スタイルの変数は、浮動小数点の原子ごとの値を返します。これらの値が分子IDのような整数変数に割り当てられる場合、浮動小数点値はその整数部分に切り捨てられます。例えば、値が 2.6 の場合は 2 になります。

キーワード type は、選択されたすべての原子に対して原子タイプを設定します。指定された値は、[create_box]() コマンドや、[read_data]()a コマンドで読み取られるデータファイルのヘッダー内の原子タイプフィールドによって設定された ntypes の範囲（1から ntypes まで）でなければなりません。

キーワード type/fraction は、選択された原子のうちの一部に対して原子タイプを設定します。変更される原子の実際の数は、指定された割合と完全には一致しない可能性がありますが、統計的には近い値となります。ランダムな数値が使用されますが、プロセッサ数に関わらず、特定の原子が変更されるか否かが決まるようになっています。このキーワードでは、原子スタイルの変数を使用することはできません。

キーワード mol は、選択されたすべての原子に対して分子IDを設定します。使用している[atom style]()が分子IDの使用をサポートしている必要があります。

キーワード x、y、z、および charge は、選択されたすべての原子の座標または電荷を設定します。電荷については、使用している[atom style]()が原子の電荷の使用をサポートしている必要があります。

キーワード dipole は、指定された x、y、z の値をベクトルの成分として使用し、選択された原子の双極子モーメントベクトルの方向として設定します。双極子モーメントの大きさは、この方向ベクトルの長さによって設定されます。

キーワード dipole/random は、選択された原子の双極子モーメントベクトルの方向をランダム化し、各双極子モーメントの大きさを指定された Dlen 値に設定します。2次元システムでは、方向の z 成分は 0.0 に設定されます。ランダムな数値が使用されますが、プロセッサ数に関係なく、特定の原子の方向が一定であるように設定されています。このキーワードでは、原子スタイルの変数を使用することはできません。

キーワード quat は、指定された値を使用してクォータニオン（4成分ベクトル）を作成し、選択された原子の方向を表現します。粒子は、[atom_style ellipsoid]() コマンドで定義された楕円体、[atom_style tri]() コマンドで定義された三角形、または [atom_style tri]() コマンドで定義されたスーパークアドラティックでなければなりません。[atom_style ellipsoid]() で定義された粒子には 3 つの形状パラメータがあります。このコマンドで設定される各粒子について、3 つの値は 0 以外である必要があります。これらは、楕円体粒子のアスペクト比を指定するために使用されます。この粒子はデフォルトでは、シミュレーションボックスの x 軸、y 軸、z 軸に沿って配置されます。もしこの粒子が単位回転ベクトル（a,b,c）を中心に角度 theta だけ右手系の法則で回転される場合、その新しい方向を表すクォータニオンは (cos(theta/2), a*sin(theta/2), b*sin(theta/2), c*sin(theta/2)) となります。theta と a,b,c の値が quat キーワードの引数として指定されます。LIGGGHTS(R)-PUBLIC は、(a,b,c) が単位ベクトルとして指定されていない場合にクォータニオンを正規化します。2次元システムでは、a,b,c の値は無視されます。なぜなら、回転ベクトルとして (0,0,1) のみが有効だからです。

キーワード quat/random は、選択された原子のクォータニオンの方向をランダム化します。粒子は、[atom_style ellipsoid]() コマンドで定義された楕円体、[atom_style tri]() コマンドで定義された三角形、または [atom_style superquadric]() コマンドで定義されたスーパークアドラティックでなければなりません。ランダムな数値が使用されますが、プロセッサ数に関係なく、特定の原子の方向は一定に保たれます。2次元システムでは、xy 平面内でのみ方向が生成されます。キーワード quat と同様に、楕円体およびスーパークアドラティック粒子では、3 つの形状値がそれぞれの粒子に対して 0 以外である必要があります。このキーワードでは、原子スタイルの変数を使用することはできません。

キーワード quat_direct は、単位回転ベクトルや回転角から計算する代わりに、指定された値から直接クォータニオンを作成します。このキーワードは quat キーワードの代替として使用されます。

キーワード diameter は、選択された原子のサイズを設定します。粒子は、[atom_style sphere]() コマンドで定義された有限サイズの球体でなければなりません。粒子の直径は 0.0 に設定することができ、これは点粒子として扱われることを意味します。ただし、このコマンドは粒子の質量を調整しません。例えば、[read_data]() コマンドを通じて密度で質量が定義されていた場合でも、質量には影響しません。

キーワード shape は、選択された原子のサイズと形状を設定します。粒子は、[atom_style ellipsoid]() または [atom_style superquadric]() コマンドで定義された楕円体またはスーパークアドラティック形状である必要があります。Sx、Sy、Sz の設定は、それぞれの方向における楕円体の直径、またはスーパークアドラティック形状の半軸の長さを示します。3つすべてを同じ値に設定すると、楕円体は実質的に球体になります。また、すべてを 0.0 に設定すると、粒子は点粒子として扱われます。なお、このコマンドは粒子の質量を調整しません。例えば、read_data コマンドを使用して密度で質量が定義されていた場合でも、その質量には影響しません。

キーワード length は、選択された原子の長さを設定します。粒子は、[atom_style line]() コマンドで定義された線分である必要があります。指定された値が 0 以外の場合、線分は指定された長さに設定（または再設定）され、その中心は粒子の位置に配置され、x 軸に沿った方向に配置されます。指定された値が 0.0 の場合、粒子は点粒子になります。なお、このコマンドは粒子の質量を調整しません。例えば、[read_data]() コマンドを使用して密度で質量が定義されていた場合でも、その質量には影響しません。

キーワード tri は、選択された原子のサイズを設定します。粒子は、[atom_style tri]() コマンドで定義された三角形である必要があります。指定された値が 0 以外の場合、三角形は再設定され、粒子の位置を重心として、xy 平面上に一辺の長さが指定された値の正三角形として配置されます。この際、三角形の底辺は x 軸に平行で、y 軸が底辺の中心から三角形の頂点へ向かう方向に設定されます。指定された値が 0.0 の場合、粒子は点粒子になります。なお、このコマンドは粒子の質量を調整しません。例えば、[read_data]() コマンドを使用して密度で質量が定義されていた場合でも、その質量には影響しません。

キーワード theta は、選択された原子の向きを設定します。粒子は、[atom_style line]() コマンドで定義された線分である必要があります。指定された値は、線分の x 軸に対する角度として向きを設定するために使用されます。

キーワード angmom は、選択された原子の角運動量を設定します。粒子は、[atom_style ellipsoid]() コマンドで定義された楕円体、[atom_style tri]() コマンドで定義された三角形、または [atom_style superquadric]() コマンドで定義されたスーパークアドラティック形状である必要があります。粒子の角運動量ベクトルは、指定された 3 つの成分値に設定されます。

キーワード mass は、選択されたすべての粒子の質量を設定します。粒子は、[atom_style]() コマンドによって定義された1粒子あたりの質量属性を持っている必要があります。「mass コマンド」を参照すると、タイプごとに質量値を設定する方法が説明されています。

キーワード density は、異なる方法で選択されたすべての粒子の質量を設定します。粒子は、[atom_style]() コマンドによって定義された1粒子あたりの質量属性を持っている必要があります。以下の条件に基づき質量が設定されます：
粒子が半径属性を持ち（[atom_style sphere]() を参照）、その半径が 0 でない場合、密度と粒子の体積から質量が設定されます。
粒子が形状属性を持ち（[atom_style ellipsoid]() を参照）、その形状パラメータの 3 つがすべて 0 でない場合、密度と粒子の体積から質量が設定されます。
粒子が長さ属性を持ち（[atom_style line]() を参照）、その長さが 0 でない場合、密度と線分の長さから質量が設定されます（入力される密度は「質量/距離」の単位であると仮定されます）。
粒子が面積属性を持ち（[atom_style tri]() を参照）、その面積が 0 でない場合、密度と三角形の面積から質量が設定されます（入力される密度は「質量/距離²」の単位であると仮定されます）。
これらの条件がいずれも該当しない場合、密度の値がそのまま質量として設定されます（入力される密度は「質量」の単位であると仮定されます）。

キーワード volume は、選択されたすべての粒子の体積を設定します。現在、[atom_style peri]() コマンドのみが体積属性を持つ粒子を定義します。ただし、このコマンドは粒子の質量を調整しません。

キーワード image は、シミュレーションボックス内で粒子がどのイメージ（画像）に属すると見なされるかを設定します。
0 の値は、粒子が定義されたボックス内にあることを意味します。
2 の値は、ボックスの長さを 2 倍加えた位置に粒子が存在することを示します。
-1 の値は、ボックスの長さを 1 倍減じた位置に粒子が存在することを示します。
LIGGGHTS(R)-PUBLIC は、シミュレーション中に粒子が周期境界を越えると、これらのフラグを更新します。このフラグは、dump コマンドを使って粒子のスナップショットとともに出力できます。
nx、ny、nz のいずれかに NULL が指定された場合、その次元における現在のイメージ値は変更されません。非周期的な次元では、0 の値のみ指定可能です。このキーワードは、atom-style 変数の使用を許可していません。

このコマンドは、システムが平衡化され、粒子がさまざまな方向にボックスの長さを 1 回以上越えて拡散した後に役立ちます。このコマンドにより、例えば [compute msd]() コマンドを使って拡散係数を測定する際に、粒子のイメージ値をリセットして粒子をシミュレーションボックス内に効果的に戻すことができます。
ただし、周期境界をまたぐ結合を持つ 2 つの粒子については注意が必要です。イメージフラグを同じ値にリセットすると、（結合が周期境界をまたいでいる場合）正しくない結果を招く可能性があります。これはシミュレーションの動力学には影響しませんが、LIGGGHTS(R)-PUBLIC の診断機能や独自の解析がイメージフラグに依存して、周期ボックスをまたぐ分子を展開しようとする場合、軌跡解析に問題を引き起こす可能性があります。

キーワード bond は、選択された原子のすべての結合の結合タイプを、指定された値（1 から nbondtypes まで）に設定します。
結合の変更を行うには、特定の結合に属するすべての原子が選択された原子である必要があります。
nbondtypes の値は、[read_data]() コマンドで読み込まれるデータファイルのヘッダーの結合タイプフィールドで設定されます。
このキーワードは、atom-style 変数の使用を許可していません。

キーワード property/atom は、[fix property/atom]() コマンドによって定義された粒子ごとのプロパティを更新できます。
varname は設定したい変数の名前を指定します。その後に、この変数に割り当てる値を指定します。
var_value\*\*i\*\* として提供される値の数は、更新に必要な値の数と一致している必要があります。たとえば、定義されたプロパティがスカラーの場合は var_value\*\*0\*\* のみを指定し、プロパティがベクトルの場合は適切な数の値を指定します。
粒子ごとのプロパティの定義方法については、[fix property/atom]() の詳細を参照してください。

キーワード add と until は、property/atom キーワードに加えて、粒子ごとの量（またはプロパティ）を追加するために使用されます。
add キーワードは、指定された領域またはグループ内で量の加算を有効にします。

until キーワードは、加算を有効にするタイムステップを定義します。
キーワード shape と blockiness は、粒子のスーパークアドリック形状を定義します。

## 制限事項
原子属性（例えば、mol や q や volume）は、[atom_style]() がその属性を持っていない場合、設定することはできません。

このコマンドは、結合タイプ（角度タイプなど）を設定するためにプロセッサ間の通信を必要とします。これは、シミュレーションを実行する準備が整っている必要があることを意味します（例えば、力場の設定、原子質量の設定など）。他のキーワードにはこれが必要ありません。

bond（angle など）キーワードを region スタイルと組み合わせて使用する場合、結合（角度など）が周期境界をまたいでいると予測できない結果を招くことがあります。これは、領域が境界までしか拡張されないため、結合（角度など）のパートナー原子がゴースト原子である場合、シミュレーションボックス外に座標があることが原因です。

quat_direct と blockiness キーワードは、[atom_style]() superquadric を必要とします。

## 関連コマンド
[create_box], [create_atoms], [read_data]

## デフォルト
none