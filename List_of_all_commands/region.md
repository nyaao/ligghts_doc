# region command

## 構文
```
region ID style args keyword arg ...
```

- ID = ユーザーが割り当てた領域の名前
- style = delete、block、cone、cylinder、plane、prism、sphere、mesh/tet、union、intersect、wedge のいずれか

delete = 引数なし  
block 引数 = xlo xhi ylo yhi zlo zhi  
xlo,xhi,ylo,yhi,zlo,zhi = ブロックの各次元の境界（距離単位）  
cone 引数 = dim c1 c2 radlo radhi lo hi  
dim = x、y、または z = 円錐の軸  
c1, c2 = 他の2次元での円錐軸の座標（距離単位）  
radlo, radhi = 円錐の半径（下端と上端）（距離単位）  
lo, hi = dim次元の円錐の範囲（距離単位）  
cylinder 引数 = dim c1 c2 radius lo hi  
dim = x、y、または z = 円筒の軸  
c1, c2 = 他の2次元での円筒軸の座標（距離単位）  
radius = 円筒の半径（距離単位）  
radius は変数（以下参照）として指定可能  
lo, hi = dim次元の円筒の範囲（距離単位）  
plane 引数 = px py pz nx ny nz  
px, py, pz = 平面上の点（距離単位）  
nx, ny, nz = 平面の法線方向（距離単位）  
prism 引数 = xlo xhi ylo yhi zlo zhi xy xz yz  
xlo,xhi,ylo,yhi,zlo,zhi = 傾斜していないプリズムの境界（距離単位）  
xy = x方向へのyの傾斜（距離単位）  
xz = x方向へのzの傾斜（距離単位）  
yz = y方向へのzの傾斜（距離単位）  
sphere 引数 = x y z radius  
x, y, z = 球の中心（距離単位）  
radius = 球の半径（距離単位）  
mesh/tet 引数 = file filename scale s move offx offy offz rotate phix phiy phiz  
file = 必須キーワード  
filename = VTKテトラメッシュデータを含むASCII VTKファイルの名前  
scale = 必須キーワード  
s = メッシュのスケーリング係数（無次元）  
move = 必須キーワード  
offx, offy, offz = メッシュのオフセット（距離単位）  
rotate = 必須キーワード  
phix, phiy, phiz = x、y、z軸周りのメッシュの回転角度（度）  
wedge 引数 = axis dim center c1 c2 radius r bounds lo hi angle0 alpha0 angle alpha  
axis = 必須キーワード  
dim = x、y、または z ... この次元に合わせて楔形が配置される  
center = 必須キーワード  
c1 = 最初の中心座標  
dim == x の場合は y 座標  
dim == y の場合は z 座標  
dim == z の場合は x 座標  
c2 = 2 番目の中心座標  
dim == x の場合は z 座標  
dim == y の場合は x 座標  
dim == z の場合は y 座標  
radius = 必須キーワード  
r = 円筒の半径  
bounds = 必須キーワード  
lo = 楔形の下の平面の dim 座標  
hi = 楔形の上の平面の dim 座標  
angle0 = 必須キーワード  
alpha0 = 楔形の開始面の角度（数学的に正の角度）  
axis == x の場合は y 軸から開始  
axis == y の場合は z 軸から開始  
axis == z の場合は x 軸から開始  
angle = 必須キーワード  
alpha = 楔形の開始面と終了面の間の角度（度単位）  
union 引数 = N reg-ID1 reg-ID2 ...  
N = 続く領域の数、2以上でなければならない  
reg-ID1, reg-ID2, ... = 結合する領域の ID  
intersect 引数 = N reg-ID1 reg-ID2 ...  
N = 続く領域の数、2以上でなければならない  
reg-ID1, reg-ID2, ... = 交差する領域の ID  


- 0個以上のキーワード/引数ペアを追加することができます
- キーワード = side、units、move、rotate

side の値 = in または out  
in = 領域は指定された幾何学内にあります  
out = 領域は指定された幾何学外にあります  
units の値 = lattice または box  
lattice = 幾何学は格子単位で定義されています  
box = 幾何学はシミュレーションボックス単位で定義されています  
move 引数 = v_x v_y v_z  
v_x, v_y, v_z = 領域の時間による x, y, z の変位を表す等式スタイルの変数  
rotate 引数 = v_theta Px Py Pz Rx Ry Rz  
v_theta = 領域の時間による回転を表す等式スタイルの変数（ラジアン単位）  
Px, Py, Pz = 回転軸の原点（距離単位）  
Rx, Ry, Rz = 回転軸のベクトル  

## 例
```
region 1 block -3.0 5.0 INF 10.0 INF INF
region 2 sphere 0.0 0.0 0.0 5 side out
region void cylinder y 2 3 5 -5.0 EDGE units box
region 1 prism 0 10 0 10 0 10 2 0 0
region outside union 4 side1 side2 side3 side4
region 2 sphere 0.0 0.0 0.0 5 side out move v_left v_up NULL
region 1 wedge axis y  center 0 0  radius 10 bounds 0 10 angle0 -22.5 angle 45 units box side in
```

## 説明
このコマンドは空間の幾何学的な領域を定義します。その他のさまざまなコマンドがこの領域を使用します。例えば、[create_atoms]() コマンドを使って領域内に原子を配置したり、[create_box]() コマンドで領域を囲むバウンディングボックスを使ってシミュレーションボックスを定義したりできます。また、group コマンドを使って領域内の原子をグループとして識別したり、[delete_atoms]() コマンドで削除したりすることもできます。さらに、[fix wall/region]() コマンドを使って領域の表面を境界壁として使用することもできます。

領域を使用するコマンドは通常、原子の位置が領域内に含まれているかどうかをテストします。この目的のため、領域の境界上に正確に位置する座標は領域内と見なされます。例えば、球形の領域の場合、もし球が「side in」キーワードで定義されていれば、球面上の原子はその領域の一部として扱われますが、「side out」キーワードで定義されていれば、領域の一部とは見なされません。side キーワードの詳細については、以下で説明します。

通常、LIGGGHTS(R)-PUBLICの領域は「静的」であり、その幾何学的な範囲は時間とともに変化しません。しかし、下記で説明するように move や rotate キーワードを使用すると、領域は「動的」になり、その位置や向きが時間とともに変化します。例えば、compute temp/region コマンドを使って領域をサーモスタットする場合や、fix wall/region コマンドで領域の表面を粒子の動きに対する境界壁として使用する場合（回転する容器）に役立ちます。

delete スタイルは指定された領域を削除します。追加の領域を定義することによるオーバーヘッドはほとんどないため、通常はこれを行う必要はありません。入力スクリプトで多くの領域を定義して破棄する場合を除いて、削除する必要はありません。

ブロック、コーン、シリンダー、またはプリズムスタイルの lo/hi 値は、EDGE または INF として指定できます。EDGE は、それらがグローバルなシミュレーションボックスの境界まで延びていることを意味します。これは現在のボックス境界を指します。シミュレーション中にボックスのサイズが変更される場合でも、領域自体は変更されません。INF は非常に大きな負の数または正の数（1.0e20）を意味し、ボックスがサイズ変更されてもシミュレーションボックスを包含するようになります。シミュレーションボックスが作成される前（[create_box]()、[read_data]()、または [read_restart]() コマンドで）に領域が定義される場合、EDGE または INF パラメータは使用できません。プリズム領域の場合、任意の2つの次元間で非ゼロのティルト係数が使用されている場合、その次元での lo/hi 値がどちらも INF であってはなりません。例えば、xy ティルトが非ゼロの場合、xlo と xhi はどちらも INF であってはならず、ylo と yhi も同様です。

[!WARNING]LIGGGHTS(R)-PUBLIC の領域は、[boundary]() コマンドで指定された周期境界を越えてラップされることはありません。例えば、周期境界と重なるように定義された球形領域は、シミュレーションボックスの両側にある 2 つの半球として扱われることはありません。

[!WARNING]LIGGGHTS(R)-PUBLIC の領域は、シミュレーション[dimension]()が 2 次元または 3 次元であるかに関係なく、常に 3 次元の幾何学的なオブジェクトです。したがって、2 次元のシミュレーションで領域を使用する場合は、領域を定義する際にその 2 次元 x-y 平面との交差が、望む 2 次元の幾何学的な範囲を持つように注意する必要があります。

スタイル cone では、軸に沿った円錐が定義されます。円錐はシリンダーのようなものですが、両端で異なる半径（それぞれの端で異なる半径）を定義できます。どちらか一方の半径（両方ではなく）が 0.0 にすることができます。

スタイル cone と cylinder では、c1, c2 パラメータはシリンダー軸の次元以外の 2 つの次元における座標です。例えば、dim = x の場合、c1/c2 = y/z、dim = y の場合、c1/c2 = x/z、dim = z の場合、c1/c2 = x/y となります。したがって、上記の 3 番目の例は、y 軸方向に軸があり、x = 2.0 および z = 3.0 の位置にあり、半径 5.0 のシリンダーを定義し、その範囲は y 軸方向に -5.0 から上のボックス境界まで拡がるシリンダーを指定しています。

スタイル plane では、点 (px, py, pz) を含み、法線ベクトル (nx, ny, nz) を持つ平面が定義されます。法線ベクトルは単位長である必要はありません。平面の「内側」は、法線ベクトルの方向の半空間です。詳細は下記の side オプションに関する説明を参照してください。

スタイル prism では、平行六面体が定義されます（入力スクリプトで「平行六面体」をスペル通りに書くのは難しいですね！）。この平行六面体は、その「原点」が (xlo, ylo, zlo) にあり、原点から出発する 3 つの辺ベクトルによって定義されます。これらは A = (xhi-xlo, 0, 0)、B = (xy, yhi-ylo, 0)、C = (xz, yz, zhi-zlo) と与えられます。xy, xz, yz は 0.0 または正の値、負の値であり、「傾斜因子」と呼ばれます。これらは、元々直交していたボックスの面に適用される変位量で、平行六面体に変換するためのものです。

[create_box]() コマンドで triclinic シミュレーションボックスを定義するために使用されるプリズム領域は、傾斜因子 (xy, xz, yz) がボックスの対応する平行ボックスの長さの半分以上に歪まないようにしなければなりません。例えば、xlo = 2 および xhi = 12 の場合、x方向のボックス長は 10 で、xy 傾斜因子は -5 から 5 の間でなければなりません。同様に、xz および yz はそれぞれ -(xhi - xlo) / 2 から +(yhi - ylo) / 2 の間でなければなりません。これは制限ではなく、最大傾斜因子が 5 であれば（この例では）、傾斜因子が ..., -15, -5, 5, 15, 25, ... といった構成はすべて幾何学的に同等であるためです。

スタイル sphere および cylinder の半径値は、equal-style [variable]()として指定することができます。値が変数の場合、v_name のように変数名を指定する必要があります。この場合、変数は各タイムステップごとに評価され、その値が領域の半径を決定するために使用されます。

Equal-style 変数は、さまざまな数学的関数を用いた式を指定でき、シミュレーションボックスのパラメータやタイムステップおよび経過時間を示す [thermo_style]() コマンドのキーワードを含めることができます。これにより、時間依存の半径を簡単に指定することができます。

LIGGGHTS(R)-PUBLIC によって定義された三斜めボックスの幾何学的記述と、これらのパラメータを他の一般的に使用される三斜め表現に変換する方法については、ドキュメントのセクション 12 を参照してください。

スタイル mesh/tet では、ASCII VTK ファイルから四面体メッシュを読み込むことができます。インポートしたメッシュには、専用のキーワードを使用してオフセット、スケーリング、回転を適用できます。これらの操作を複数適用する場合、最初にオフセットが適用され、その後にジオメトリがスケーリングされます。その後、ジオメトリは最初に x 軸回りに回転し、次に y 軸回り、最後に z 軸回りに回転します。

[!WARNING]現在、サポートされているのは四面体を含むASCII VTKのみです。周期境界条件の場合、メッシュはマッピングされません。代わりに、頂点がシミュレーションボックスの外にある場合に警告が生成されます。
union スタイルは、リストされたすべての領域を組み合わせた体積からなる領域を作成します。intersect スタイルは、リストされたすべての領域に共通する体積からなる領域を作成します。

[!WARNING]union および intersect 領域は、それぞれのサブ領域のリストからメソッドを呼び出すことによって操作されます。したがって、union または intersect 領域を定義した後でサブ領域を削除することはできません。

side キーワードは、指定された幾何学形状の内側または外側として領域が考慮されるかを決定します。このキーワードを union および intersect 領域と組み合わせて使用することで、複雑な幾何学形状を構築できます。例えば、2つの球体の内部をそれぞれ領域として定義し、union スタイルで side = out を指定して、2つの球体の領域IDをリストにした場合、結果として得られる領域は、シミュレーションボックス内で両方の球体の外側にあるすべての体積となります。

units キーワードは、上記で距離単位が使用される引数に対して、領域を定義する際の距離単位の意味を決定します。また、このキーワードは、vel キーワードで指定された速度ベクトル、wiggle キーワードで指定された振幅ベクトル、rotate キーワードで指定された回転点のスケーリングにも影響を与えます。これらはすべて距離測定基準に関係しています。

box 値は、[units]() コマンドで定義された標準距離単位を選択します。例えば、units = real または metal の場合はアンストローム（Å）が使用されます。lattice 値は、距離単位が格子間隔であることを意味します。[lattice]() コマンドは、これらの格子間隔を定義するために以前に使用されている必要があります。

- block スタイルでは、x 次元の格子間隔が xlo と xhi に適用され、同様に y および z 次元の格子間隔が ylo/yhi および zlo/zhi に適用されます。
- cone スタイルでは、指定された dim 次元の格子間隔が lo と hi に適用されます。2つの放射状の次元に対する格子間隔は、c1 と c2 に適用されます。2つの円錐の半径は、c1 に対応する次元の格子間隔によってスケーリングされます。
- cylinder スタイルでは、指定された dim 次元の格子間隔が lo と hi に適用されます。2つの放射状の次元に対する格子間隔は、c1 と c2 に適用されます。円筒の半径は、c1 に対応する次元の格子間隔によってスケーリングされます。
- plane スタイルでは、x 次元の格子間隔が px と nx に適用され、同様に y および z 次元の格子間隔が py/ny および pz/nz に適用されます。
- prism スタイルでは、x 次元の格子間隔が xlo と xhi に適用され、同様に y 次元および z 次元の格子間隔が ylo/yhi と zlo/zhi に適用されます。x 次元の格子間隔は xy と xz に適用され、y 次元の格子間隔は yz に適用されます。
- sphere スタイルでは、x、y、z 次元の格子間隔が球の中心座標 x, y, z に適用されます。x 次元の格子間隔は球の半径に適用されます。

move または rotate キーワードが使用されると、領域は「動的」になり、位置や向きが時間とともに変化します。これらのキーワードは、union または intersect スタイルの領域には使用できません。代わりに、これらのキーワードは、union または intersect 領域の個々のサブ領域を動的にするために使用する必要があります。通常、各サブ領域は同様の方法で「動的」であるべきですが（例：同じ点を中心に回転させる）、これは必須ではありません。

move キーワードは、領域の x, y, z の変位を指定するために 1 つ以上の [equal-style variable]()を使用することを許可します。通常、これは時間の関数として変位を指定します。変数は v_name として指定され、name は変数の名前です。3つの変数のいずれかを NULL と指定することができ、その場合、その次元での変位計算は行われません。

equal スタイルの変数は、さまざまな数学的関数を使用した式を指定でき、シミュレーションボックスのパラメータやタイムステップ、経過時間に関する [thermo_style]() コマンドのキーワードも含むことができます。これにより、時間の関数として変化する領域の変位や、連続する実行間での変位を簡単に指定することができます。後者については、run コマンドの start と stop キーワード、および [thermo_style custom]() の elaplong キーワードを参照してください。

例えば、以下のコマンドは、領域を初期位置から正の x 軸方向に移動させ、実質的に一定の速度で移動させます：

```
variable dx equal ramp(0,10)
region 2 sphere 10.0 10.0 0.0 5 move v_dx NULL NULL
```

初期の変位は 0.0 ですが、これは必須ではありません。

これらの変数のいずれも、y 軸方向で領域を前後に「揺らす」ことができます：

```
variable dy equal swiggle(0,5,100)
variable dysame equal 5*sin(2*PI*elaplong*dt/100)
region 2 sphere 10.0 10.0 0.0 5 move NULL v_dy NULL
```

rotate キーワードは、回転軸 R = (Rx, Ry, Rz) を中心に領域を回転させます。回転軸は点 P = (Px, Py, Pz) を通ります。回転角度は、時間の関数として計算されると想定され、v_theta として指定された変数によって決定されます。この変数はラジアン単位で結果を生成する必要があります。回転軸周りの回転方向は右手の法則に従います。つまり、右手の親指を R 軸に合わせると、指が回転方向に巻きついていきます。

move と rotate キーワードは一緒に使用できます。この場合、move キーワードで指定された変位が、rotate キーワードの P 点に適用されます。

## 制限事項
プリズムはどの次元においても厚さが 0.0 であってはなりません。2D シミュレーションでは、小さな z 厚さを使用してください。2D シミュレーションの場合、xz および yz パラメータは 0.0 でなければなりません。

## 関連コマンド
[lattice](), [create_atoms](), [delete_atoms](), [group]()

## デフォルト
オプションのデフォルトは、side = in、units = box、move または rotate はなしです。