# write_restart command

## 構文
```
write_restart file keyword value ...
```

- file = 再起動情報を書き込むファイルの名前
- zero or more keyword/value pairs may be appended = 0個以上のキーワード/値ペアを追加できます
- keyword = fileper または nfile

fileper arg = Np  
Np = この数のプロセッサごとに1つのファイルを書き込む  
nfile arg = Nf  
Nf = Nf個のプロセッサから1つのファイルを書き込む  

## 例
```
write_restart restart.equil
write_restart poly.%.* nfile 10
```

## 説明
現在のシミュレーションの状態をバイナリ再起動ファイルとして書き込みます。

長時間のシミュレーションでは、通常、[restart]()コマンドを使用して定期的に再起動ファイルを出力します。write_restartコマンドは、最適化後や現在の再起動ファイルを1つ書き出したい場合に便利です。

[dump]()ファイルと同様に、再起動ファイル名には2つのワイルドカード文字を含めることができます。ファイル名に「*」が含まれている場合、それは現在のタイムステップ値に置き換えられます。ファイル名に「%」が含まれている場合、各プロセッサごとに1つのファイルが書き込まれ、「%」はプロセッサID（0からP-1まで）に置き換えられます。また、「%」が「base」に置き換えられた追加のファイルも書き込まれ、これにはグローバル情報が含まれます。例えば、ファイル名がrestart.%の場合、書き込まれるファイルはrestart.base、restart.0、restart.1、... restart.P-1になります。これにより、ファイルが小さくなり、並列マシンでの出力および後続の入力が高速になります（並列I/Oをサポートするマシンの場合）。下記のfileperおよびnfileキーワードを使用すると、書き込むファイルの数を変更できます。

再起動ファイルは、[read_restart]()コマンドを使用して特定の状態からシミュレーションを再開するために読み込むことができます。ファイルはバイナリ形式で保存されているため（正確な再起動を可能にするため）、別のマシンでは読み取れない場合があります。この場合、[-r command-line switch]()を使用して、再起動ファイルをデータファイルに変換することができます。

[!WARNING]再起動ファイルの目的は、シミュレーションを中断したところから再開することですが、シミュレーションに関するすべての情報がファイルに保存されるわけではありません。例えば、最初の実行中に指定されたfixのリストは保存されないため、新しい入力スクリプトで使用したいfixを指定する必要があります。再起動ファイルに情報が保存されている場合でも（いくつかのfixに関しては保存されています）、その情報を再利用するためには、コマンドを新しい入力スクリプトで再指定する必要がある場合があります。再起動ファイルに保存されている情報については、[read_restart]()コマンドを参照してください。

オプションのnfileまたはfileperキーワードは、指定した再起動ファイル名で「%」ワイルドカード文字と一緒に使用できます。上記で説明したように、「%」文字は再起動ファイルを複数の部分に分割して書き出します。各部分はP個のプロセッサに対応します。デフォルトでは、Pはシミュレーションが実行されているプロセッサの数です。nfileまたはfileperキーワードを使用して、Pを小さい値に設定することができます。これは、大規模なプロセッサ数で実行する際に効率的です。

nfileキーワードは、Pを指定されたNf値に設定します。例えば、Nf = 4の場合、シミュレーションが100個のプロセッサで実行されていると、4つのファイルが書き出されます。プロセッサ0、25、50、75がそれぞれ情報を集め、次の24個のプロセッサから情報を集めて再起動ファイルに書き込みます。

fileperキーワードの場合、指定されたNpの値は、Np個のプロセッサごとに1つのファイルを書き込むことを意味します。例えば、Np = 4の場合、4つごとに（0、4、8、12などのプロセッサ）が自分自身と次の3つのプロセッサから情報を集めて再起動ファイルに書き込みます。

## 制限事項
このコマンドは、再起動ファイルが書き込まれる前に原子を移動させるためにプロセッサ間通信を必要とします。つまり、このコマンドを使用する前にシミュレーションを実行できる状態にシステムを準備する必要があります（力場の設定、原子質量の初期化など）。

## 関連コマンド
[restart](), [read_restart](), [write_data]()

## デフォルト
none
