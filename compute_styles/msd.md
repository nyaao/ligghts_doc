# compute msd command

## 構文
```
compute ID group-ID msd general_keyword general_values keyword values ...
```
- ID、group-IDはcomputeコマンドに記載されています
- msd = この計算コマンドのスタイル名
- 一般的なキーワードおよび値はcomputeに記載されています
- 0個以上のキーワード/値のペアを追加できます
- キーワード = com  
comの値 = yes または no

## 例
```
compute 1 all msd
compute 1 upper msd com yes
```

## 説明
この計算は、原子が周期境界を越える効果を含む、原子群の平均二乗変位（MSD）を計算します。平均二乗変位の非ガウスパラメータの計算については、[compute msd/nongauss]()コマンドを参照してください。

この計算では、4つの量からなるベクトルが計算されます。ベクトルの最初の3つの要素は、dx、dy、dzの各方向の二乗変位で、グループ内の原子について合計し、平均したものです。4番目の要素は、全体の二乗変位、つまり(dxdx + dydy + dz*dz)で、これもグループ内の原子について合計し、平均したものです。

平均二乗変位（MSD）対時間の傾きは、拡散している原子の拡散係数に比例します。

原子の変位は、computeコマンドが発行された時点での元の位置からの変位です。指定された計算グループに含まれない原子の変位の値は0.0になります。

comオプションが「yes」に設定されている場合、原子群の質量中心のドリフトの影響が、各原子の変位が計算される前に差し引かれます。

[!WARNING]初期座標は「アンラップ」形式で保存されており、各原子に関連付けられたイメージフラグを使用しています。「アンラップ座標」については、[dump custom]()コマンドを参照してください。イメージフラグとその設定方法については、[read_data]()コマンドのAtomsセクションを参照してください。このcomputeを呼び出す前に、[set image]()コマンドを使用してイメージフラグをリセット（例えば0に設定）できます。

[!WARNING]原子が剛体の一部である場合（[fix rigid]()コマンド参照）、その周期的なイメージフラグは変更され、MSDへの寄与が正確でない可能性があります。詳細については、[fix rigid]()コマンドを参照してください。したがって、剛体が周期的境界を越えるときのMSDを計算するには、体内の原子の座標を含む[dump file]()を後処理する必要があります。

[!WARNING]このcomputeで計算される量が再開ファイルから実行する際に連続的であることを望む場合は、元の実行と同じIDをこのcomputeに使用する必要があります。これにより、作成されたfixも同じIDを持ち、再開ファイルからの原子座標で正しく初期化されます。

## 出力情報
この計算は長さ4のグローバルベクターを計算し、インデックス1〜4でアクセスできます。このベクターは、計算からグローバルベクター値を入力として使用するコマンドで使用できます。LIGGGHTS(R)-PUBLICの出力オプションの概要については、このセクションを参照してください。

ベクター値は「集中的（intensive）」です。ベクター値は距離^2の[units]()で表されます。

## 制限事項
none

## 関連コマンド
[compute msd/nongauss](), [compute displace_atom](), [fix store/state](), [compute msd/molecule]()

## デフォルト
オプションのデフォルトは com=no です。