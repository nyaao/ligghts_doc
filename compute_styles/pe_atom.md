# compute pe/atom command

## 構文
```
compute ID group-ID pe/atom general_keyword general_values keyword ...
```
- ID、group-IDはcomputeコマンドで文書化されています。
- pe/atom = この計算コマンドのスタイル名
- 一般的なキーワードとその値はcomputeで文書化されています。
- 0個以上のキーワードを追加することができます。
- キーワード = pair、bond、angle、dihedral、improper、kspace

## 例
```
compute 1 all pe/atom
compute 1 all pe/atom pair
compute 1 all pe/atom pair bond
```

## 説明
この計算は、グループ内の各原子に対して原子ごとのポテンシャルエネルギーを計算します。システム全体のポテンシャルエネルギーが必要な場合は、[compute pe]()コマンドを参照してください。

原子ごとのエネルギーは、シミュレーションで定義された様々なペア、結合などのポテンシャルによって計算されます。追加のキーワードが指定されていない場合、ポテンシャルエネルギーはペア、結合、角度、二重結合、不正な結合、およびkspaceエネルギーの合計です。追加のキーワードが指定された場合、そのコンポーネントのみが合計されてポテンシャルエネルギーが計算されます。

各原子のエネルギーは、その原子がグループ内の他の原子だけでなく、シミュレーション内の全ての原子との相互作用によって決まることに注意してください。

例えば、少数の原子（例えば、ジヘードラルで4つの原子、Tersoff 3体相互作用で3つの原子）によって生じたエネルギーは、そのセット内の各原子に等しく割り当てられます。例えば、ジヘードラルエネルギーの1/4が4つの原子それぞれに割り当てられます。

dihedral_style charmmスタイルは、1-4原子間のペア相互作用を計算します。これらの項のエネルギー寄与は、ジヘードラルエネルギーではなくペアエネルギーに含まれます。

KSpaceの寄与は、Ewald法のための（ Heyes, Phys Rev B 49, 755 (1994),）の方法と、kspace_style pppmコマンドで指定されたPPPMの関連方法を使用して計算されます。PPPMの場合、計算には各タイムステップで原子ごとのエネルギーが計算されるたびに追加のFFTが1回必要です。この文書では、長距離の原子ごとのエネルギー計算がどのように行われるかについて説明しています。

原子ごとのポテンシャルエネルギーと総ポテンシャルエネルギーの比較の例として、入力スクリプトのこれらの行は、thermo出力の最後の2列で同じ結果を得るはずです。

```
compute              peratom all pe/atom
compute              pe all reduce sum c_peratom
thermo_style custom step temp etotal press pe c_pe
```


[!WARNING]原子ごとのエネルギーには、pair_modify tail yesコマンドによって呼び出されたレナード・ジョーンズの尾部補正は含まれません。これらはシステムエネルギーへのグローバルな寄与だからです。

## 出力情報
この計算は、原子ごとのベクトルを計算します。このベクトルは、計算から原子ごとの値を入力として使用する任意のコマンドでアクセスできます。LIGGGHTS(R)-PUBLICの出力オプションの概要については、セクション15をご覧ください。

原子ごとのベクトル値はエネルギー単位で示されます。

## 制限事項
この計算には、粒子間の重なりによる粒状粒子のポテンシャルエネルギーは含まれません。

## 関連コマンド
[compute pe](), [compute stress/atom]()

## デフォルト
none