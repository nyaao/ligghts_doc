# compute pair/gran/local command
# compute wall/gran/local command

## 構文
```
compute ID group-ID pair/gran/local general_keywords general_values keywords ...
compute ID group-ID wall/gran/local general_keywords general_values keywords ...
```
- ID, group-ID は compute コマンドで文書化されています。
- pair/gran/local または wall/gran/local はこの計算コマンドのスタイル名です。
- 一般的なキーワードとその値は compute で文書化されています。
- 0個以上のキーワードを追加することができます。
- キーワード = pos, vel, id, force, torque, history, contactArea, delta:l

pos = 接触している粒子の位置（6値）  
vel = 接触している粒子の速度（6値）  
id = 接触している粒子のIDおよび周期性フラグ（3値）、またはメッシュ、三角形、および粒子のID（3値）  
force = 接触力（3値）  
force_normal = 接触力の法線成分（3値）  
force_tangential = 接触力の接線成分（3値）  
torque = 粒子の直径で割ったトルク（3値）  
history = 接触履歴（#はペアスタイルに依存、例えば3つのせん断履歴値）  
contactArea = 接触面積（1値）  
contactPoint = 接触点（3値）  
delta = 接触の重なり（1値）  
heatFlux = 接触の伝導熱フラックス（1値）  
ms_id = 接触している粒子が属する多球体（クランプ）のID（壁の場合、2番目の値は-1）（2値）  

## 例
```
compute 1 all pair/gran/local
compute 1 all pair/gran/local pos force
compute 1 all wall/gran/local
```

## 説明
粒子対粒子または粒子-壁相互作用の個別の特性を計算する計算を定義します。システム内のペアワイズ相互作用または粒子-壁相互作用の数に基づいて生成されるデータの数は、すべてのプロセッサで集計されます。

このコマンドによって格納されるローカルデータは、ペアワイズの隣接リストをループすることによって生成されます。個別のペアワイズ相互作用に関する情報は、ペアの両方の原子が指定された計算グループに属し、現在のペアワイズ距離がその相互作用の力のカットオフ距離より小さい場合にのみ含まれます。この距離は、[pair_style]() および [pair_coeff]() コマンドで定義されています。

[!WARNING]粒子-壁接触データにアクセスするには、メッシュ壁（fix mesh参照）のみを使用できます。粒子-壁計算（compute wall/gran/local）の場合、コードは自動的にメッシュ壁を使用する[fix wall/gran]()コマンドを探します。fix wall/granコマンド内のメッシュの順序はメッシュIDと呼ばれ（0から始まります）、三角形のIDはSTL/VTKファイルから読み込まれる三角形の順序を反映します。三角形IDを出力する方法については、「dump mesh/gran/VTKコマンド」を参照してください。

出力のposは粒子の位置（6値）で、距離[units]()です。キーワードvelは速度についても同様のことを行います。ペアデータを計算する場合、出力idは2つの粒子ID（このオプションを使用するには原子マップを使用する必要があります）と、周期境界を越えた相互作用に対して1、そうでない場合は0のフラグになります。粒子-壁データを計算する場合、出力idはメッシュID、三角形ID、および粒子IDになります。出力のforce、force_normal、force_tangential、torqueは、接触力の合計、接触力の法線成分および接線成分、そして粒子半径で割ったトルクであり、いずれも力の[units]()で表示されます。法線および接線成分は、使用される法線および接線モデルによって追加された力と正確に等しくない可能性があることに注意してくださいが、これは粒子中心間の接続線を法線方向として幾何学的に構成されたものです。また、トルクには転がり摩擦トルクは含まれていません。出力のhistoryは、使用される粒子対粒子スタイルに応じて、この履歴が何を表すかによって異なります。出力のcontactAreaは、接触面積を距離^2の[units]()で出力します。contactAreaは、力学に基づいた計算ではなく、球-球または球-平面の交差の解析的幾何学的計算に基づいていることに注意してください。これにより、すべてのタイプの接触モデルでcontactAreaが機能することが保証されます。contactPointの出力は、接触力が計算される接触点を格納します。

出力のdeltaは、重なり（半径の合計 - 粒子中心間の距離）を距離単位で出力します。出力のheatFlux（fix heat/granを使用して熱フラックスを計算する場合にのみ利用可能）は、接触ごとの導電性熱フラックス面積をエネルギー/時間の[units]()で出力します。

[!WARNING]異なるキーワードに関連するデータは、次の順序で出力されます：pos、vel、id、force、force_normal、force_tangential、torque、history、contactArea、heatFlux、contactPoint。この順序は、キーワードが指定される順序とは独立しています。

注意：原子がプロセッサ間で移動するため、ローカルベクターまたは配列内のエントリの順序は、次のタイムステップにおいて一貫していない場合があります。保証される一貫性は、特定のタイムステップでの順序が他の計算コマンドによって生成されたローカルベクターや配列の順序と同じであることです。例えば、[compute property/local]()コマンドからのペア出力は、このコマンドからのデータと組み合わせて、[dump local]()コマンドによって一貫した方法で出力することができます。

[!WARNING]この計算は、呼び出されたときに、現在の位置、速度などを考慮して接触力を計算するために、ペアや壁の接触モデルに呼び出しを行います。

この計算は通常、出力が作成されるとき（タイムステップの最後）に行われるため、この計算結果が1回のタイムステップ内で計算されたp-pやp-w力と機械精度で正確に一致するわけではありません。

## 出力情報
この計算は、指定されたキーワードの数に応じて、ローカルベクターまたはローカル配列を計算します。ベクターの長さまたは配列の行数はペアの数に対応します。キーワードが1つだけ指定されている場合は、ローカルベクターが生成されます。2つ以上のキーワードが指定されている場合は、列数がキーワードの数に対応するローカル配列が生成されます。ベクターまたは配列は、計算からローカル値を入力として使用するコマンドでアクセスできます。このセクションでは、LIGGGHTS(R)-PUBLICの出力オプションの概要を確認できます。

出力の[units]()に関する情報については、上記をご覧ください。

## 制限事項
この計算は、粒子対粒子のペアスタイルと一緒にのみ使用できます。粒子-壁接触データにアクセスするためには、メッシュ壁のみを使用できます。

## 関連コマンド
[dump local](), [compute property/local]()

## デフォルト
デフォルトでは、すべての出力キーワード（force_normal、force_tangential、heat flux、および delta を除く）は有効になっています。つまり、キーワードが指定されていない場合、位置、速度、ID、力、トルク、履歴、および接触面積が出力されます。