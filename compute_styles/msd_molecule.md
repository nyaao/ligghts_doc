# compute msd/molecule command

## 構文
```
compute ID group-ID msd/molecule general_keyword general_values
```
- ID, group-ID are documented in compute command
- msd/molecule = style name of this compute command
- general_keywords general_values are documented in compute

## 例
```
compute 1 all msd/molecule
```

## 説明

個々の分子の平均二乗変位（MSD）を計算する計算を定義します。この計算には、原子が周期的境界を越える影響も含まれます。

この計算は、各分子について4つの量を計算します。最初の3つの量は、重心のdx、dy、dzの二乗変位です。4番目の成分は、重心の総二乗変位、つまり(dxdx + dydy + dz*dz)です。

平均二乗変位（MSD）と時間の関係の傾きは、拡散する分子の拡散係数に比例します。

分子の重心の変位は、計算コマンドが発行された時点でのその分子の元の重心位置からの変位です。

特定の分子のMSDは、その分子の1つ以上の原子が指定されたグループに含まれている場合にのみ計算されます。通常、分子内のすべての原子はグループに含まれているべきですが、これは必須ではありません。この場合、LIGGGHTS(R)-PUBLICは警告を出します。計算に寄与するのは、グループ内の原子のみで、これに基づいて分子の重心位置が計算され、初期位置と現在位置が求められます。

この計算によって生成される分子ごとの量の順序は、他の分子ごとのデータを生成する計算コマンドによって生成される順序と一致します。概念的には、指定されたグループに1つ以上の原子が含まれる分子の分子IDは昇順になります。

[!WARNING]各分子の初期座標は、「アンラップ」形式で保存されており、各原子に関連付けられたイメージフラグを使用しています。アンラップ座標については、[dump custom]()コマンドで説明しています。イメージフラグとそれが各原子にどのように設定されるかについては、[read_data]()コマンドのAtomsセクションを参照してください。この計算を実行する前に、[set image]()コマンドを使用してイメージフラグ（例えば0に）をリセットできます。

[!WARNING]原子が剛体の一部である場合（[fix rigid]()コマンドを参照）、その周期的なイメージフラグが変更され、MSDへの寄与が実際の寄与を反映しない可能性があります。詳細については、[fix rigid]()コマンドを参照してください。そのため、剛体が周期境界を越える際のMSDを計算するには、剛体内の原子の座標を含むダンプファイルを後処理する必要があります。

[!WARNING][compute msd]()コマンドとは異なり、この計算は分子の初期重心座標をリスタートファイルに保存しません。したがって、[restart file]()から実行する際に、この計算の分子ごとのMSD計算を続行することはできません。

## 出力情報
この計算は、行数がNmolecules（分子の数）で、列数が4（dx、dy、dz、および総移動量）のグローバル配列を計算します。これらの値は、計算からのグローバル配列値を入力として使用する任意のコマンドでアクセスできます。LIGGGHTS(R)-PUBLICの出力オプションの概要については、このセクションを参照してください。

配列の値は「集中的」です。配列の値は距離^2の[units]()で表されます。

## 制限事項
none

## 関連コマンド
[compute msd]()

## デフォルト
none