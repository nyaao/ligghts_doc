# compute rdf command

## 構文
```
compute ID group-ID rdf general_keyword general_values Nbin itype1 jtype1 itype2 jtype2 ...
```
- ID, group-IDは計算コマンドで文書化されています。
- rdf = この計算コマンドのスタイル名
- general_keywords general_valuesは計算コマンドで文書化されています。
- Nbin = RDFのビンの数
- itypeN = N番目のRDFヒストグラムの中心原子のタイプ（以下のアスタリスク形式を参照）
- jtypeN = N番目のRDFヒストグラムの分布原子のタイプ（以下のアスタリスク形式を参照）

## 例
```
compute 1 all rdf 100
compute 1 all rdf 100 1 1
compute 1 all rdf 100 * 3
compute 1 fluid rdf 500 1 1 1 2 2 1 2 2
compute 1 fluid rdf 500 1*3 2 5 *10
```

## 説明
計算を定義して、粒子のグループのために放射線分布関数（RDF）、別名g(r)、および配位数を計算します。両方は、[pair_style]()コマンドで定義された最大力カットオフまで、Nbin個のビンにペア距離をバンニングすることでヒストグラム形式で計算されます。ビンは半径距離で均一なサイズです。したがって、1つのビンは3次元では薄いシェル、2次元では薄いリングの距離を含みます。

[!WARNING]結合されたシステムを使用している場合、special_bondsコマンドの設定により、同じ結合、角度、またはジヘドラル内の原子間のペア相互作用が削除されることがあります。これはspecial_bondsコマンドのデフォルト設定であり、これらのペア相互作用は隣接リストに表示されません。このfixが隣接リストを使用しているため、これらのペアはRDFに含まれません。これを回避する方法の1つは、ダンプファイルを書き、rerunコマンドを使用してダンプファイル内のスナップショットに対してRDFを計算することです。rerunスクリプトは、隣接リストのすべてのペアを含むspecial_bondsコマンドを使用できます。

itypeNおよびjtypeN引数はオプションです。これらの引数はペアで指定する必要があります。ペアがリストされていない場合、すべての原子タイプ間でg(r)の単一のヒストグラムが計算されます。1つ以上のペアがリストされている場合、各itype,jtypeペアごとに個別のヒストグラムが生成されます。

itypeNおよびjtypeNの設定は2通りの方法で指定できます。明示的な数値を使用する方法（上記の4番目の例のように）と、ワイルドカードのアスタリスクを使用して原子タイプの範囲を指定する方法です。これは「」や「n」、または「n」と「mn」の形で指定できます。N = 原子タイプの数の場合、数値がないアスタリスクは1からNまでのすべてのタイプを意味します。先頭にアスタリスクがある場合は1からnまで（nを含む）のすべてのタイプを意味します。末尾にアスタリスクがある場合はnからNまで（nを含む）のすべてのタイプを意味します。中央にアスタリスクがある場合はmからnまで（両端を含む）のすべてのタイプを意味します。

itypeNおよびjtypeNの両方が単一の値である場合（上記の4番目の例のように）、これは、itypeNタイプの原子が中央の原子で、jtypeNタイプの原子が分布原子としてg(r)が計算されることを意味します。もしitypeNおよびjtypeNのいずれかがワイルドカードのアスタリスクを使って範囲の値を表している場合（上記の5番目の例のように）、これは、itypeNで表される範囲のタイプのいずれかの原子が中央の原子として、jtypeNで表される範囲のタイプのいずれかの原子が分布原子としてg(r)が計算されることを意味します。


ペアワイズ距離は、pair_style計算と同様にペアワイズ隣接リストをループすることによって生成されます。2つの原子IおよびJの間の距離は、次の条件が満たされる場合に特定のヒストグラムに含まれます：

- 原子IとJが指定された計算グループに両方とも含まれていること
- 原子IとJの間の距離が最大フォースカットオフより小さいこと
- 原子IのタイプがitypeN（1つまたはタイプの範囲）に一致すること
- 原子JのタイプがjtypeN（1つまたはタイプの範囲）に一致すること

itypeNおよびjtypeN引数が指定される方法によって、特定のペアワイズ距離が複数の個別のヒストグラムに含まれることは問題ありません。

g(r)の値は、ヒストグラムのカウントをスケーリングすることによって計算され、jtypeNの原子が均等に分布している場合の理想的なカウント数でスケーリングされます。これには、itypeN原子のカウント、jtypeN原子のカウント、シミュレーションボックス全体の体積、そして3Dでのビンの薄いシェルの体積（または2Dでのビンの薄いリングの面積）が含まれます。

また、座標数coord(r)も計算されます。これは、現在のビン内またはそれより近い場所にあるjtypeN原子の数で、itypeN原子に対して平均化されたものです。これは、g(r)の値をすべてのビンにわたって面積または体積加重で合計し、jtypeN原子のグローバルな平均体積密度を掛けた値として計算されます。

計算結果をファイルに出力する最も簡単な方法は、例えば[fix ave/time]()コマンドを使用することです。

```
compute myRDF all rdf 50
fix 1 all ave/time 100 1 100 c_myRDF file tmp.rdf mode vector
```

## 出力情報
この計算は、行数 = Nbins、列数 = 1 + 2 * Npairs のグローバル配列を計算します。ここで、Npairs は指定されたI,Jペアの数です。最初の列にはビンの座標（ビンの中心）があり、次の2列ごとに、特定のitypeN対jtypeN相互作用に対するg(r)とcoord(r)の値が含まれています。これらの値は、計算結果からグローバル値を入力として使用する任意のコマンドで使用できます。LIGGGHTS(R)-PUBLICの出力オプションの概要については、セクション_howto 15を参照してください。

この計算で計算された配列の値はすべて「密度依存的」です。

配列の最初の列の値は距離の[units]()になります。g(r)の列の値は、0.0以上の正規化された数値です。座標数の列の値も、0.0以上の数値です。

## 制限事項
RDFは、フォースカットオフ距離よりも長い距離では計算されません。これは、プロセッサ（並列処理）がその距離より遠くの原子の座標を認識できないためです。より大きな距離でのRDFが必要な場合は、rerunコマンドを使用してダンプファイルをポストプロセスすることができます。LIGGGHTS(R)-PUBLICで使用されるg(r)の定義は、シミュレーションセル全体に均等に分布している原子を特徴付ける場合にのみ適用されます。このような場合、座標数は依然として正しく意味があります。例えば、大きなシミュレーションセルに、タイプitypeNの原子とタイプjtypeNの原子がそれぞれ1個ずつ含まれている場合、g(r)は、両者が偶然にいる距離で任意の大きさのスパイクを登録し、その他の場所ではゼロになります。coord(r)は、g(r)のスパイクの位置でゼロから1へのステップ変化を示します。

## 関連コマンド
[fix ave/time]()

## デフォルト
none