# dump local/gran/vtk command

# 構文
```
dump ID group-ID style N file ID
```
- ID = ダンプのためにユーザーが割り当てた名前
- group-ID = ダンプする原子群のID
- style = local/gran/vtk
- N = このステップ数ごとにダンプを実行
- file = ダンプ情報を書き込むファイル名

ID = compute pair/gran/local または wall/gran/local のID

# 例
```
compute cpgl all pair/gran/local pos vel force
dump dmp2 all local/gran/vtk 100 post/forcechain*.vtp cpgl
dump dmp3 all local/gran/vtk 200 post/forcechain*.pvtu cpgl
```

# 説明
粒状または粒状結合量のスナップショットを、N ステップごとに1つ以上のファイルにダンプします。ID は、データをダンプするために使用する [compute pair/gran/local]() または [wall/gran/local]() のIDを指します。

ダンプ出力が書き込まれるタイムステップは、変数で制御できます。詳細については [dump_modify every]() コマンドを参照してください。指定されたグループの原子に関する情報のみがダンプされます。[dump_modify thresh および region]() コマンドによって、含まれる原子が変更されることもあります。詳細は以下を参照してください。ファイル名における特殊文字「*」とサフィックスが、出力の種類を決定します。

[!NOTE]Paraviewでは、「Tube」フィルターを使用して、VTKラインデータの可視化を行うことができます。

結合データのダンプに関する説明：

オプションとして、結合量をダンプするためには、このコマンドは凝集結合粒状ペアスタイル相互作用がアクティブである必要があり、compute pair/gran/local や wall/gran/local コマンドの代わりに、[compute pair/gran/local/bond]() コマンドを使用する必要があります。
```
compute bonds all pair/gran/local/bond
```


結合ダンプにおいて、VTKに出力される値は以下のようにハードコードされています：
||||
|--|--|--|
|x1：|結合の粒子iの位置|（3つの値、ベクトル）|
|x2：|結合の粒子jの位置|（3つの値、ベクトル）|
|id1：|粒子iのID|（1つの値、スカラー）|
|id2：|粒子jのID|（1つの値、スカラー）|
|force：|結合粒子間の総力（結合およびペア貢献を含む）|（3つの値、ベクトル）|
|torque：|結合粒子間の総トルク（結合およびペア貢献を含む）|（3つの値、ベクトル）|
|force_normal：|結合粒子間の法線方向の総力（結合およびペア貢献を含む）|（3つの値、ベクトル）|
|force_tangential：|結合粒子間の接線方向の総力（結合およびペア貢献を含む）|（3つの値、ベクトル）|

[!WARNING]結合ボンドが実際に活性化している粒子のデータのみが出力に含まれます。ただし、F、Tなどは総力およびトルクであり、ヘルツの法線力など他の貢献を含んでいます。

[!WARNING]周期的境界条件は隣接リストが再構築されるタイムステップでのみ適用されるため、ダンプファイルに書き込まれる原子の座標はシミュレーションボックスの外にわずかに出ている可能性があります。

[!WARNING]出力データには周期的境界条件を越えて引き伸ばされた結合に関する情報は含まれていません。通常、視覚化エンジンは周期的境界条件を越えて引き伸ばされた結合を検出しません。

VTKフォーマットはファイルごとにシステムの単一スナップショットを使用するため、ファイル名にワイルドカード「*」を含める必要があります。そうでないと、新しいスナップショットがダンプファイルを上書きしてしまいます。

ダンプは、Nの倍数のタイムステップ（タイムステップ0を含む）および最適化が収束した場合の最適化の最終タイムステップで実行されます。これは、現在のタイムステップがNの倍数でない場合、ダンプコマンドが呼び出された後の最初のタイムステップにはダンプが実行されないことを意味します。この動作は、[dump_modify first]() コマンドで変更できます。このコマンドは、最適化が任意のタイムステップで終了した後にダンプコマンドを呼び出す場合にも役立ちます。Nは、[dump_modify every]() コマンドを使用することで実行間で変更できます。[dump_modify every]() コマンドは、ダンプファイルが書き込まれるタイムステップの順序を決定するために変数を使用することもできます。このモードでは、[dump_modify first]() コマンドを使用しない限り、実行の最初のタイムステップでのダンプも書き込まれません。

ダンプのファイル名には2つのワイルドカード文字を含めることができます。ファイル名に「」文字が含まれている場合、各スナップショットに対して1つのファイルが書き込まれ、「」文字はタイムステップの値に置き換えられます。例えば、tmp.dump*.vtk は tmp.dump0.vtk、tmp.dump10000.vtk、tmp.dump20000.vtk などになります。なお、[dump_modify pad]() コマンドを使用して、すべてのタイムステップ番号の長さを同じにすることができます（例：00010）。これにより、いくつかの後処理ツールを使用してダンプファイルの系列を順番に読みやすくすることができます。

出力ファイルを並列で書き込む場合、ファイル名は「.pvtu」または「.pvtp」で終わる必要があります。例えば、ファイル名が「data.pvtu」の場合、この名前のファイルが1つ書き込まれます。このファイルには、各プロセッサが書き込んだ「data_X.vtu」ファイルへのリンクが含まれます。ここで、X（= 0,...,P-1）はファイルを書き込んだプロセッサのIDです。したがって、ParaViewでデータを可視化するには「data.pvtu」ファイルを開きます。並列で出力を行うことは、分散型HPCクラスタで特に重要で、実行時間を大幅に短縮することができます。

[!NOTE]従来の「.vtk」ファイル形式は並列書き込みをサポートしていません。

デフォルトでは、P = プロセッサの数であり、プロセッサごとに1つのファイルが書き込まれますが、[dump_modify]() コマンドの nfile または fileper キーワードを使用して、Pをより小さな値に設定することができます。これらのオプションは、大規模なプロセッサで実行する際にダンプファイルを最も効率的に書き出す方法となる場合があります。

「*」文字と並列ファイルタイプを一緒に使用すると、非常に多くの小さなダンプファイルが生成されることがありますので、注意してください。

dump_modify binary が使用される場合、ダンプファイルはバイナリ形式で書き込まれます。バイナリダンプファイルはテキスト版とほぼ同じサイズになりますが、通常は書き込みが非常に速く行われます。さらに、dump_modify compressor を使用して、圧縮されたバイナリデータの書き込みを指定することができます。圧縮器のオプションには以下のようなものがあります：
```
none: No compression
zlib: Zlib compression
lz4: Lz4 compression (VTK >= 8.0 required)
```

# 制限事項
local/gran/vtk スタイルは、gzip圧縮されたダンプファイルの書き込みをサポートしておらず、トリクリニック型のシミュレーションボックスにも対応していません。

local/gran/vtk を使用するには、VTKライブラリにリンクする必要があります。これを実現するために、Makefileを適切に修正してください。また、LIGGGHTS(R)-PUBLICを -DLAMMPS_VTK オプションでコンパイルする必要があります。詳細は「Making LIGGGHTS(R)-PUBLIC」セクションを参照してください。

local/gran/vtk ダンプスタイルは、バッファリングやカスタムフォーマット文字列もサポートしていません。

# 関連コマンド
[dump](), [dump image](), [dump_modify](), [undump]()

# デフォルト
デフォルトでは、ファイルはASCII形式で書き込まれます。ファイル拡張子が .vtk、.vtp、または .vtu のいずれでもない場合、従来のVTKファイル形式が使用されます。